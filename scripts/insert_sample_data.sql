-- =============================================================================
-- PostgreSQL サンプルデータ投入スクリプト
-- 株価データ取得システム用サンプルデータ（8テーブル構成）
-- =============================================================================

-- セッション設定
SET client_encoding = 'UTF8';
SET timezone = 'Asia/Tokyo';

-- 現在の接続情報を確認
SELECT
    current_database() as "接続中のデータベース",
    current_user as "現在のユーザー",
    CURRENT_TIMESTAMP as "実行開始時刻";

-- =============================================================================
-- 注意事項
-- =============================================================================
-- このスクリプトは開発・テスト用のサンプルデータを投入します。
-- 本番環境では実行しないでください。
-- 
-- 既存データをクリーンアップする場合は、以下のコメントアウトを解除してください：
-- DELETE FROM stocks_1d;
-- DELETE FROM stocks_1m;
-- DELETE FROM stocks_5m;
-- DELETE FROM stocks_15m;
-- DELETE FROM stocks_30m;
-- DELETE FROM stocks_1h;
-- DELETE FROM stocks_1wk;
-- DELETE FROM stocks_1mo;

-- =============================================================================
-- 1. stocks_1d テーブル（日足データ）サンプル投入
-- =============================================================================

INSERT INTO stocks_1d (symbol, date, open, high, low, close, volume) VALUES
-- トヨタ自動車（7203.T）- 2024年9月第1週
('7203.T', '2024-09-02', 2850.00, 2890.00, 2840.00, 2875.00, 12500000),
('7203.T', '2024-09-03', 2875.00, 2920.00, 2860.00, 2910.00, 13200000),
('7203.T', '2024-09-04', 2910.00, 2935.00, 2895.00, 2925.00, 11800000),
('7203.T', '2024-09-05', 2925.00, 2950.00, 2905.00, 2940.00, 12100000),
('7203.T', '2024-09-06', 2940.00, 2965.00, 2930.00, 2955.00, 10900000),

-- ソニーグループ（6758.T）- 2024年9月第1週
('6758.T', '2024-09-02', 12800.00, 12950.00, 12750.00, 12900.00, 2800000),
('6758.T', '2024-09-03', 12900.00, 13100.00, 12850.00, 13050.00, 3200000),
('6758.T', '2024-09-04', 13050.00, 13200.00, 13000.00, 13150.00, 2900000),
('6758.T', '2024-09-05', 13150.00, 13300.00, 13100.00, 13250.00, 3100000),
('6758.T', '2024-09-06', 13250.00, 13400.00, 13200.00, 13350.00, 2700000),

-- 三菱UFJフィナンシャル・グループ（8306.T）- 2024年9月第1週
('8306.T', '2024-09-02', 1450.00, 1475.00, 1440.00, 1465.00, 45000000),
('8306.T', '2024-09-03', 1465.00, 1490.00, 1455.00, 1480.00, 48000000),
('8306.T', '2024-09-04', 1480.00, 1500.00, 1470.00, 1495.00, 42000000),
('8306.T', '2024-09-05', 1495.00, 1520.00, 1485.00, 1510.00, 46000000),
('8306.T', '2024-09-06', 1510.00, 1535.00, 1500.00, 1525.00, 41000000),

-- 任天堂（7974.T）- 2024年9月第1週
('7974.T', '2024-09-02', 6800.00, 6950.00, 6750.00, 6900.00, 1800000),
('7974.T', '2024-09-03', 6900.00, 7100.00, 6850.00, 7050.00, 2100000),
('7974.T', '2024-09-04', 7050.00, 7200.00, 7000.00, 7150.00, 1900000),
('7974.T', '2024-09-05', 7150.00, 7300.00, 7100.00, 7250.00, 2000000),
('7974.T', '2024-09-06', 7250.00, 7400.00, 7200.00, 7350.00, 1700000);

-- =============================================================================
-- 2. stocks_1m テーブル（1分足データ）サンプル投入
-- =============================================================================

INSERT INTO stocks_1m (symbol, datetime, open, high, low, close, volume) VALUES
-- トヨタ自動車（7203.T）- 2024年9月2日 9:00-9:05の1分足データ
('7203.T', '2024-09-02 09:00:00+09', 2850.00, 2855.00, 2848.00, 2852.00, 125000),
('7203.T', '2024-09-02 09:01:00+09', 2852.00, 2858.00, 2850.00, 2856.00, 132000),
('7203.T', '2024-09-02 09:02:00+09', 2856.00, 2862.00, 2854.00, 2860.00, 118000),
('7203.T', '2024-09-02 09:03:00+09', 2860.00, 2865.00, 2857.00, 2863.00, 121000),
('7203.T', '2024-09-02 09:04:00+09', 2863.00, 2868.00, 2860.00, 2865.00, 109000),

-- ソニーグループ（6758.T）- 2024年9月2日 9:00-9:05の1分足データ
('6758.T', '2024-09-02 09:00:00+09', 12800.00, 12820.00, 12795.00, 12815.00, 28000),
('6758.T', '2024-09-02 09:01:00+09', 12815.00, 12835.00, 12810.00, 12830.00, 32000),
('6758.T', '2024-09-02 09:02:00+09', 12830.00, 12845.00, 12825.00, 12840.00, 29000),
('6758.T', '2024-09-02 09:03:00+09', 12840.00, 12855.00, 12835.00, 12850.00, 31000),
('6758.T', '2024-09-02 09:04:00+09', 12850.00, 12865.00, 12845.00, 12860.00, 27000);

-- =============================================================================
-- 3. stocks_5m テーブル（5分足データ）サンプル投入
-- =============================================================================

INSERT INTO stocks_5m (symbol, datetime, open, high, low, close, volume) VALUES
-- トヨタ自動車（7203.T）- 2024年9月2日 9:00-9:30の5分足データ
('7203.T', '2024-09-02 09:00:00+09', 2850.00, 2868.00, 2848.00, 2865.00, 605000),
('7203.T', '2024-09-02 09:05:00+09', 2865.00, 2875.00, 2860.00, 2870.00, 580000),
('7203.T', '2024-09-02 09:10:00+09', 2870.00, 2880.00, 2865.00, 2875.00, 620000),
('7203.T', '2024-09-02 09:15:00+09', 2875.00, 2885.00, 2870.00, 2880.00, 590000),
('7203.T', '2024-09-02 09:20:00+09', 2880.00, 2890.00, 2875.00, 2885.00, 610000),
('7203.T', '2024-09-02 09:25:00+09', 2885.00, 2890.00, 2880.00, 2887.00, 595000),

-- ソニーグループ（6758.T）- 2024年9月2日 9:00-9:30の5分足データ
('6758.T', '2024-09-02 09:00:00+09', 12800.00, 12865.00, 12795.00, 12860.00, 147000),
('6758.T', '2024-09-02 09:05:00+09', 12860.00, 12880.00, 12850.00, 12875.00, 140000),
('6758.T', '2024-09-02 09:10:00+09', 12875.00, 12895.00, 12865.00, 12890.00, 152000),
('6758.T', '2024-09-02 09:15:00+09', 12890.00, 12910.00, 12880.00, 12905.00, 145000),
('6758.T', '2024-09-02 09:20:00+09', 12905.00, 12925.00, 12895.00, 12920.00, 158000),
('6758.T', '2024-09-02 09:25:00+09', 12920.00, 12935.00, 12910.00, 12930.00, 148000);

-- =============================================================================
-- 4. stocks_15m テーブル（15分足データ）サンプル投入
-- =============================================================================

INSERT INTO stocks_15m (symbol, datetime, open, high, low, close, volume) VALUES
-- トヨタ自動車（7203.T）- 2024年9月2日の15分足データ
('7203.T', '2024-09-02 09:00:00+09', 2850.00, 2885.00, 2848.00, 2880.00, 1815000),
('7203.T', '2024-09-02 09:15:00+09', 2880.00, 2890.00, 2870.00, 2887.00, 1795000),
('7203.T', '2024-09-02 09:30:00+09', 2887.00, 2895.00, 2880.00, 2890.00, 1820000),
('7203.T', '2024-09-02 09:45:00+09', 2890.00, 2890.00, 2875.00, 2885.00, 1780000),

-- ソニーグループ（6758.T）- 2024年9月2日の15分足データ
('6758.T', '2024-09-02 09:00:00+09', 12800.00, 12935.00, 12795.00, 12930.00, 439000),
('6758.T', '2024-09-02 09:15:00+09', 12930.00, 12950.00, 12910.00, 12945.00, 425000),
('6758.T', '2024-09-02 09:30:00+09', 12945.00, 12950.00, 12920.00, 12940.00, 445000),
('6758.T', '2024-09-02 09:45:00+09', 12940.00, 12945.00, 12920.00, 12935.00, 420000);

-- =============================================================================
-- 5. stocks_30m テーブル（30分足データ）サンプル投入
-- =============================================================================

INSERT INTO stocks_30m (symbol, datetime, open, high, low, close, volume) VALUES
-- トヨタ自動車（7203.T）- 2024年9月2日の30分足データ
('7203.T', '2024-09-02 09:00:00+09', 2850.00, 2895.00, 2848.00, 2887.00, 3610000),
('7203.T', '2024-09-02 09:30:00+09', 2887.00, 2895.00, 2875.00, 2885.00, 3600000),
('7203.T', '2024-09-02 10:00:00+09', 2885.00, 2890.00, 2870.00, 2875.00, 3590000),

-- ソニーグループ（6758.T）- 2024年9月2日の30分足データ
('6758.T', '2024-09-02 09:00:00+09', 12800.00, 12950.00, 12795.00, 12945.00, 864000),
('6758.T', '2024-09-02 09:30:00+09', 12945.00, 12950.00, 12920.00, 12935.00, 865000),
('6758.T', '2024-09-02 10:00:00+09', 12935.00, 12940.00, 12900.00, 12920.00, 850000);

-- =============================================================================
-- 6. stocks_1h テーブル（1時間足データ）サンプル投入
-- =============================================================================

INSERT INTO stocks_1h (symbol, datetime, open, high, low, close, volume) VALUES
-- トヨタ自動車（7203.T）- 2024年9月2日の1時間足データ
('7203.T', '2024-09-02 09:00:00+09', 2850.00, 2895.00, 2848.00, 2885.00, 7200000),
('7203.T', '2024-09-02 10:00:00+09', 2885.00, 2890.00, 2870.00, 2875.00, 7150000),
('7203.T', '2024-09-02 11:00:00+09', 2875.00, 2885.00, 2865.00, 2880.00, 7100000),

-- ソニーグループ（6758.T）- 2024年9月2日の1時間足データ
('6758.T', '2024-09-02 09:00:00+09', 12800.00, 12950.00, 12795.00, 12935.00, 1729000),
('6758.T', '2024-09-02 10:00:00+09', 12935.00, 12940.00, 12900.00, 12920.00, 1715000),
('6758.T', '2024-09-02 11:00:00+09', 12920.00, 12930.00, 12890.00, 12910.00, 1700000);

-- =============================================================================
-- 7. stocks_1wk テーブル（1週間足データ）サンプル投入
-- =============================================================================

INSERT INTO stocks_1wk (symbol, date, open, high, low, close, volume) VALUES
-- トヨタ自動車（7203.T）- 2024年9月第1週（9/2-9/6）
('7203.T', '2024-09-02', 2850.00, 2965.00, 2840.00, 2955.00, 60500000),

-- ソニーグループ（6758.T）- 2024年9月第1週（9/2-9/6）
('6758.T', '2024-09-02', 12800.00, 13400.00, 12750.00, 13350.00, 14700000),

-- 三菱UFJフィナンシャル・グループ（8306.T）- 2024年9月第1週（9/2-9/6）
('8306.T', '2024-09-02', 1450.00, 1535.00, 1440.00, 1525.00, 222000000),

-- 任天堂（7974.T）- 2024年9月第1週（9/2-9/6）
('7974.T', '2024-09-02', 6800.00, 7400.00, 6750.00, 7350.00, 9500000);

-- =============================================================================
-- 8. stocks_1mo テーブル（1ヶ月足データ）サンプル投入
-- =============================================================================

INSERT INTO stocks_1mo (symbol, date, open, high, low, close, volume) VALUES
-- トヨタ自動車（7203.T）- 2024年9月
('7203.T', '2024-09-01', 2850.00, 2965.00, 2840.00, 2955.00, 242000000),

-- ソニーグループ（6758.T）- 2024年9月
('6758.T', '2024-09-01', 12800.00, 13400.00, 12750.00, 13350.00, 58800000),

-- 三菱UFJフィナンシャル・グループ（8306.T）- 2024年9月
('8306.T', '2024-09-01', 1450.00, 1535.00, 1440.00, 1525.00, 888000000),

-- 任天堂（7974.T）- 2024年9月
('7974.T', '2024-09-01', 6800.00, 7400.00, 6750.00, 7350.00, 38000000);

-- =============================================================================
-- データ投入結果確認
-- =============================================================================

-- 各テーブルのレコード数確認
SELECT 'stocks_1d' as "テーブル名", COUNT(*) as "レコード数" FROM stocks_1d
UNION ALL
SELECT 'stocks_1m' as "テーブル名", COUNT(*) as "レコード数" FROM stocks_1m
UNION ALL
SELECT 'stocks_5m' as "テーブル名", COUNT(*) as "レコード数" FROM stocks_5m
UNION ALL
SELECT 'stocks_15m' as "テーブル名", COUNT(*) as "レコード数" FROM stocks_15m
UNION ALL
SELECT 'stocks_30m' as "テーブル名", COUNT(*) as "レコード数" FROM stocks_30m
UNION ALL
SELECT 'stocks_1h' as "テーブル名", COUNT(*) as "レコード数" FROM stocks_1h
UNION ALL
SELECT 'stocks_1wk' as "テーブル名", COUNT(*) as "レコード数" FROM stocks_1wk
UNION ALL
SELECT 'stocks_1mo' as "テーブル名", COUNT(*) as "レコード数" FROM stocks_1mo
ORDER BY "テーブル名";

-- 銘柄別レコード数確認（日足データ）
SELECT 
    symbol as "銘柄コード",
    COUNT(*) as "日足レコード数",
    MIN(date) as "最古日付",
    MAX(date) as "最新日付"
FROM stocks_1d
GROUP BY symbol
ORDER BY symbol;

-- サンプルデータ投入完了メッセージ
DO $$
BEGIN
    RAISE NOTICE '=== サンプルデータ投入完了 ===';
    RAISE NOTICE '8テーブル構成にサンプルデータを投入しました';
    RAISE NOTICE '対象銘柄: 7203.T, 6758.T, 8306.T, 7974.T';
    RAISE NOTICE '時間軸: 1分足、5分足、15分足、30分足、1時間足、日足、週足、月足';
    RAISE NOTICE 'データ確認は上記のSELECT文で実行されています';
END $$;

-- =============================================================================
-- 使用方法:
-- 1. stock_data_system データベースに stock_user で接続
--    psql -U stock_user -d stock_data_system
--
-- 2. テーブルが作成済みであることを確認
--    \dt
--
-- 3. このスクリプトを実行
--    \i scripts/insert_sample_data.sql
--
-- 4. データ確認
--    SELECT * FROM stocks_1d LIMIT 5;
--    SELECT COUNT(*) FROM stocks_1d;
-- =============================================================================
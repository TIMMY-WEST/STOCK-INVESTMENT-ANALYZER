# アーキテクチャドキュメント

株価データ取得システムのアーキテクチャに関するドキュメント集です。

## 📚 ドキュメント一覧

### 全体像・概要

#### [アーキテクチャ概要](./architecture_overview.md) 🎯
**対象**: 開発者全員、新規参加者

システム全体のアーキテクチャと技術スタックを理解するためのドキュメントです。

**含まれる内容:**
- システム全体像とレイヤー構造
- 主要コンポーネントとその役割
- 技術スタック（実装済み）
- プロジェクトディレクトリ構成

**こんな時に使用:**
- プロジェクトの全体像を把握したい
- 技術スタックを確認したい
- システム構成を理解したい

---

### レイヤーアーキテクチャ

#### [プレゼンテーション層](./layers/presentation_layer.md)
**対象**: フロントエンド開発者、UI/UX設計者

ユーザーインターフェースとHTMLテンプレートに関するドキュメントです。

**含まれる内容:**
- HTMLテンプレート構造
- 静的ファイル（CSS、JavaScript）
- UI/UXデザインパターン
- フォームとバリデーション

**こんな時に使用:**
- UI実装の方針を確認したい
- テンプレート構造を理解したい
- フロントエンドの設計を把握したい

---

#### [API層](./layers/api_layer.md)
**対象**: バックエンド開発者

HTTPエンドポイントとルーティングに関するドキュメントです。

**含まれる内容:**
- エンドポイント設計方針
- Blueprintの構成
- リクエスト/レスポンス処理
- バリデーションとエラーハンドリング

**こんな時に使用:**
- 新しいAPIエンドポイントを追加したい
- APIの設計方針を確認したい
- エラーレスポンスの標準化を理解したい

---

#### [サービス層](./layers/service_layer.md)
**対象**: バックエンド開発者

ビジネスロジックとサービスクラスに関するドキュメントです。

**含まれる内容:**
- サービスクラスの責務
- ビジネスロジックの実装パターン
- サービス間の連携
- トランザクション管理

**こんな時に使用:**
- ビジネスロジックを実装したい
- サービスの役割を確認したい
- データ処理の設計を理解したい

---

#### [データアクセス層](./layers/data_access_layer.md)
**対象**: バックエンド開発者

データベースアクセスとリポジトリパターンに関するドキュメントです。

**含まれる内容:**
- リポジトリクラスの設計
- CRUD操作のパターン
- クエリビルダーとORM使用方針
- データアクセスのベストプラクティス

**こんな時に使用:**
- データベース操作を実装したい
- リポジトリパターンを理解したい
- クエリのパフォーマンスを最適化したい

---

#### [データストレージ層](./layers/data_storage_layer.md)
**対象**: バックエンド開発者、データベース管理者

データベーススキーマとモデル定義に関するドキュメントです。

**含まれる内容:**
- 11テーブルの詳細設計（8種類の株価テーブル + 3種類の管理テーブル）
- SQLAlchemyモデル定義
- インデックス設計
- マイグレーション戦略

**こんな時に使用:**
- テーブル構造を確認したい
- 新しいカラムやテーブルを追加したい
- データベーススキーマを理解したい

---

### 横断的関心事

#### [例外処理戦略](./exception_handling.md)
**対象**: バックエンド開発者

システム全体のエラーハンドリングと例外処理に関するドキュメントです。

**含まれる内容:**
- カスタム例外クラスの設計
- 例外処理のベストプラクティス
- エラーメッセージの標準化
- ログ記録とエラートレース

**こんな時に使用:**
- 例外処理を実装したい
- エラーハンドリングの方針を確認したい
- カスタム例外を追加したい

---

#### [型定義戦略](./type_definition_strategy.md)
**対象**: バックエンド開発者

Pythonの型ヒントと型安全性に関するドキュメントです。

**含まれる内容:**
- 型ヒントの使用方針
- TypedDictとDataclassの活用
- mypyによる静的型チェック
- 型定義のベストプラクティス

**こんな時に使用:**
- 型安全なコードを書きたい
- 型定義の規約を確認したい
- mypyエラーを解決したい

---

#### [フロントエンド設計](./frontend_design.md)
**対象**: フロントエンド開発者

フロントエンドの技術的詳細と実装方針に関するドキュメントです。

**含まれる内容:**
- JavaScript実装パターン
- WebSocket/Socket.IO通信
- 非同期処理とイベントハンドリング
- CSS設計（BEM記法）

**こんな時に使用:**
- JavaScriptの実装パターンを確認したい
- リアルタイム通信を実装したい
- フロントエンドのコーディング規約を確認したい
---
## 🗺️ ドキュメントナビゲーション

### 新規参加者向けの推奨読み順

1. **[アーキテクチャ概要](./architecture_overview.md)** - まずシステム全体像を把握
2. **レイヤーアーキテクチャの理解** - 各層の責務を順に理解
   - [プレゼンテーション層](./layers/presentation_layer.md)
   - [API層](./layers/api_layer.md)
   - [サービス層](./layers/service_layer.md)
   - [データアクセス層](./layers/data_access_layer.md)
   - [データストレージ層](./layers/data_storage_layer.md)
3. **横断的関心事** - システム全体に関わる設計方針
   - [例外処理戦略](./exception_handling.md)
   - [型定義戦略](./type_definition_strategy.md)

### バックエンド開発者向け

- **システム理解**: [アーキテクチャ概要](./architecture_overview.md)
- **API開発**: [API層](./layers/api_layer.md)
- **ビジネスロジック実装**: [サービス層](./layers/service_layer.md)
- **データベース操作**: [データアクセス層](./layers/data_access_layer.md) → [データストレージ層](./layers/data_storage_layer.md)
- **エラーハンドリング**: [例外処理戦略](./exception_handling.md)
- **型安全性**: [型定義戦略](./type_definition_strategy.md)

### フロントエンド開発者向け

- **システム理解**: [アーキテクチャ概要](./architecture_overview.md)
- **UI実装**: [プレゼンテーション層](./layers/presentation_layer.md) → [フロントエンド設計](./frontend_design.md)
- **データ連携**: [API層](./layers/api_layer.md)
---
## 🔗 関連ドキュメント

### API仕様
- [APIドキュメント](../api/README.md) - API仕様と使用例
- [APIリファレンス](../api/api_reference.md) - 全エンドポイント詳細
- [API使用例ガイド](../api/api_usage_guide.md) - 実践的なサンプルコード
- [APIバージョニングガイド](../api/versioning_guide.md) - APIバージョン管理戦略

### 開発ガイド
- [セットアップガイド](../guides/setup_guide.md) - セットアップと開発手順
- [テスト標準仕様書](../standards/testing-standards.md) - テスト戦略とテストコード

---
## 📝 ドキュメント更新履歴

### 2025-01-10
- ✅ レイヤーアーキテクチャドキュメントを追加（layers/）
  - プレゼンテーション層、API層、サービス層、データアクセス層、データストレージ層
- ✅ 横断的関心事のドキュメントを追加
  - 例外処理戦略、型定義戦略
- ✅ 削除されたドキュメントへの参照を削除
  - data_flow.md、component_dependency.md、service_responsibilities.md、database_design.md
- ✅ ドキュメント構造を現在の実装状況に合わせて再編成

### 2025-01-02
- ✅ ドキュメント構成を整理・統合
- ✅ `architecture_overview.md` を新規作成（`project_architecture.md` と `system_overview.md` を統合）
- ✅ 全ドキュメントを現在の実装状況に更新（8時間軸実装済み、サービスモジュール化反映）
- ✅ `api_endpoints_overview.md` を削除（`docs/api/api_reference.md` に統合済み）
- ✅ ナビゲーションガイド（本README）を追加

### 2025-10-25
- プロジェクト全体アーキテクチャを初期作成
---
## ❓ よくある質問

### Q: どのドキュメントから読めばいいですか？

**A:** 目的に応じて以下を選択してください：
- **全体像を把握したい** → [アーキテクチャ概要](./architecture_overview.md)
- **レイヤーの責務を理解したい** → [layers/](./layers/) 内の各レイヤードキュメント
- **エラーハンドリングを知りたい** → [例外処理戦略](./exception_handling.md)
- **型定義の方針を確認したい** → [型定義戦略](./type_definition_strategy.md)
- **DBスキーマを確認したい** → [データストレージ層](./layers/data_storage_layer.md)

### Q: 新機能を追加する際、どのドキュメントを参照すべきですか？

**A:** 以下の順序で確認してください：
1. [アーキテクチャ概要](./architecture_overview.md) - システム全体の構造を理解
2. [サービス層](./layers/service_layer.md) - ビジネスロジックをどこに実装すべきか確認
3. [API層](./layers/api_layer.md) - エンドポイントの設計方針を確認
4. [データアクセス層](./layers/data_access_layer.md) - データベース操作の実装方法を確認
5. [例外処理戦略](./exception_handling.md) - エラーハンドリングの方針を確認

### Q: アーキテクチャドキュメントとAPI仕様書の違いは？

**A:**
- **アーキテクチャドキュメント（ここ）**: システムの内部構造、設計方針、実装詳細
- **API仕様書（`docs/api/`）**: 外部から利用するAPIの使い方、エンドポイント、パラメータ

開発者は両方を参照し、API利用者はAPI仕様書のみを参照します。

### Q: レイヤーアーキテクチャの各層の役割は？

**A:**
- **プレゼンテーション層**: ユーザーインターフェースとHTMLテンプレート
- **API層**: HTTPエンドポイントとルーティング
- **サービス層**: ビジネスロジックとトランザクション管理
- **データアクセス層**: データベース操作とリポジトリパターン
- **データストレージ層**: データベーススキーマとモデル定義

詳細は各レイヤーのドキュメントを参照してください。

---
**最終更新**: 2025-01-10

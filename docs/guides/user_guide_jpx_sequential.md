---
category: guide
ai_context: medium
last_updated: 2025-10-18
related_docs:
  - ../api/api_jpx_sequential.md
  - ../development/jpx_integration_spec.md
---

# JPX全銘柄8種類順次自動取得 - ユーザーガイド

## 概要

この機能は、JPX（日本取引所グループ）に上場している全銘柄の株価データを、**8種類の時間軸で順次自動的に取得**する強力な機能です。

**たった1つのボタンをクリックするだけで、すべての作業が自動で完了します。**

## 機能の特徴

### 🚀 ワンクリック操作

1つのボタンで8種類すべての時間軸データを自動取得：
- ボタン1つで処理開始
- 銘柄一覧の取得から各時間軸のデータ取得まで、すべて自動
- 進捗状況をリアルタイムで確認可能

### 📊 取得される8種類の時間軸

| 番号 | 時間軸 | 取得期間 | 用途 |
|------|--------|----------|------|
| 1 | 1分足 | 5日間 | デイトレード、超短期分析 |
| 2 | 5分足 | 1ヶ月 | 短期トレード |
| 3 | 15分足 | 1ヶ月 | スイングトレード準備 |
| 4 | 30分足 | 1ヶ月 | 中短期分析 |
| 5 | 1時間足 | 2年 | スイングトレード |
| 6 | 1日足 | 最大期間 | 中長期投資 |
| 7 | 週足 | 最大期間 | 長期投資 |
| 8 | 月足 | 最大期間 | 超長期投資 |

### ✅ 各時間軸の実行結果を可視化

- 各時間軸ごとの成功/失敗銘柄数
- ダウンロードしたデータ件数
- データベースに保存した件数
- 処理時間
- エラーが発生した場合の詳細情報

## 使い方

### ステップ1: Webアプリケーションにアクセス

1. サーバーを起動:
```bash
python app/app.py
```

2. ブラウザで以下のURLにアクセス:
```
http://127.0.0.1:8000
```

### ステップ2: 設定を選択

「🚀 JPX全銘柄8種類順次自動取得」セクションで、以下の設定を選択します：

#### 取得銘柄数

|  選択肢  |  説明  |  推奨用途  |
|----------|--------|------------|
| 10銘柄（テスト用） | 動作確認用 | 初めて使う場合のテスト |
| 50銘柄 | 小規模取得 | 特定の銘柄グループ |
| 100銘柄 | 中規模取得（デフォルト） | バランスの良い選択 |
| 500銘柄 | 大規模取得 | 広範囲の分析 |
| 1000銘柄 | 超大規模取得 | 包括的な分析 |
| 5000銘柄（全銘柄） | 完全取得 | すべての上場銘柄 |

#### 市場区分（オプション）

| 選択肢 | 説明 |
|--------|------|
| 全市場 | すべての市場の銘柄を取得 |
| プライム市場のみ | 東証プライム市場の銘柄のみ |
| スタンダード市場のみ | 東証スタンダード市場の銘柄のみ |
| グロース市場のみ | 東証グロース市場の銘柄のみ |

### ステップ3: 取得開始

**「🚀 8種類データ順次自動取得 開始」ボタンをクリック**

これだけで、以下の処理がすべて自動で実行されます：

1. JPX銘柄マスタから銘柄一覧を取得
2. 1分足データの取得（全銘柄）
3. 5分足データの取得（全銘柄）
4. 15分足データの取得（全銘柄）
5. 30分足データの取得（全銘柄）
6. 1時間足データの取得（全銘柄）
7. 1日足データの取得（全銘柄）
8. 週足データの取得（全銘柄）
9. 月足データの取得（全銘柄）

### ステップ4: 進捗確認

実行中は以下の情報がリアルタイムで表示されます：

#### 処理状況
- **対象銘柄数**: 取得する銘柄の総数
- **完了時間軸**: 完了した時間軸数 / 総時間軸数（8）
- **現在の時間軸**: 現在処理中の時間軸

#### 各時間軸の実行結果

各時間軸の処理が完了すると、以下の情報が表示されます：

```
✅ 1. 1分足、5日間
   成功: 95 / 100 銘柄
   失敗: 5 銘柄
   ダウンロード: 47,500 件
   保存: 47,500 件
   処理時間: 125.5秒
```

### ステップ5: 結果確認

全時間軸の処理が完了すると、最終結果サマリーが表示されます：

```
✅ 全時間軸のデータ取得が完了しました！

総時間軸数: 8
完了: 8
成功: 8
失敗: 0
```

## 処理時間の目安

| 銘柄数 | 推定処理時間 |
|--------|--------------|
| 10銘柄 | 約2〜3分 |
| 50銘柄 | 約10〜15分 |
| 100銘柄 | 約20〜30分 |
| 500銘柄 | 約2〜3時間 |
| 1000銘柄 | 約4〜6時間 |
| 5000銘柄 | 約100分（1時間40分） |

**注意**: 処理時間はネットワーク速度、サーバー負荷、Yahoo Finance APIのレート制限により変動します。

## よくある質問

### Q1: 処理を途中で停止できますか？

**A**: はい、「⏸️ 停止」ボタンをクリックすることで、処理を停止できます。ただし、現在処理中の銘柄が完了するまで若干の時間がかかる場合があります。

### Q2: 一部の時間軸でエラーが発生した場合はどうなりますか？

**A**: 一部の時間軸でエラーが発生しても、残りの時間軸の処理は継続されます。各時間軸の結果は個別に表示され、どの時間軸が成功/失敗したかを確認できます。

### Q3: 既に取得済みのデータはどうなりますか？

**A**: 既存のデータは上書きされます（重複排除機能により、同じ日時のデータは更新されます）。

### Q4: 処理中にブラウザを閉じても大丈夫ですか？

**A**: 処理はサーバー側で実行されているため、ブラウザを閉じても処理は継続されます。ただし、進捗の確認ができなくなります。再度ページを開いても、進捗状況は表示されません（現在の実装では）。

### Q5: 銘柄マスタが古い場合はどうすれば良いですか？

**A**: 「JPX全銘柄自動取得（単一時間軸）」セクションの「JPX銘柄リスト取得 & 全銘柄データ取得開始」ボタンを先に実行して、銘柄マスタを最新化してください。

### Q6: エラーが多発する場合の対処法は？

**A**: 以下を確認してください：
- インターネット接続が安定しているか
- Yahoo Finance APIが正常に動作しているか
- サーバーのログを確認（`logs/` ディレクトリ）
- 銘柄数を減らして再試行

## トラブルシューティング

### エラー: 「銘柄一覧の取得に失敗しました」

**原因**:
- JPX銘柄マスタが空、または設定された市場区分に該当する銘柄がない

**対処法**:
1. 「JPX全銘柄自動取得（単一時間軸）」セクションで銘柄マスタを更新
2. 市場区分の設定を「全市場」に変更

### エラー: 「ジョブの開始に失敗しました」

**原因**:
- サーバーエラー
- データベース接続エラー

**対処法**:
1. サーバーのログを確認
2. データベース接続をテスト（「システム状態」セクションの「接続テスト実行」）
3. サーバーを再起動

### 一部の銘柄でデータ取得が失敗する

**原因**:
- 銘柄コードが無効
- Yahoo Finance APIでデータが提供されていない
- レート制限

**対処法**:
- これは正常な動作です
- 失敗した銘柄は「失敗」としてカウントされ、処理は継続されます
- 失敗銘柄が多い場合は、時間をおいて再試行

## 技術仕様

### API エンドポイント

- **銘柄一覧取得**: `GET /api/bulk/jpx-sequential/get-symbols`
- **順次取得開始**: `POST /api/bulk/jpx-sequential/start`
- **ステータス確認**: `GET /api/bulk/status/{job_id}`

### データ保存先

取得したデータは以下のテーブルに保存されます：

- `stock_1m`: 1分足データ
- `stock_5m`: 5分足データ
- `stock_15m`: 15分足データ
- `stock_30m`: 30分足データ
- `stock_1h`: 1時間足データ
- `stock_daily`: 日足データ
- `stock_weekly`: 週足データ
- `stock_monthly`: 月足データ

### バッチ実行履歴

Phase 2が有効な場合、実行履歴は `batch_executions` テーブルに保存されます。

## まとめ

この機能を使えば、**たった1回のボタンクリック**で、JPX全銘柄の包括的な株価データを自動取得できます。

各時間軸の実行結果がリアルタイムで可視化されるため、処理の進捗と結果を簡単に確認できます。

ぜひこの強力な機能を活用して、効率的なデータ収集を実現してください！
